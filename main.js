!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r){var o=n.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.name,this._link=e.link,this._handleCardClick=o,this._cardSelector=r}var n,r;return n=t,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_handleLikeButtonToggle",value:function(e){e.target.classList.toggle("element__like-button_active")}},{key:"_handleDeleteCard",value:function(){this._element.remove()}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__image").style.backgroundImage="url(".concat(this._link,")"),this._element.querySelector(".element__text").textContent=this._name,this._element}},{key:"_setEventListeners",value:function(){var e=this,t=this._element.querySelector(".element__like-button"),n=this._element.querySelector(".element__delete-button"),r=this._element.querySelector(".element__image");t.addEventListener("click",(function(t){return e._handleLikeButtonToggle(t)})),n.addEventListener("click",(function(){return e._handleDeleteCard()})),r.addEventListener("click",(function(){return e._handleCardClick({name:e._name,link:e._link})}))}}])&&e(n.prototype,r),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initialArray=r,this._renderer=o,this._container=document.querySelector(n)}var t,r;return t=e,(r=[{key:"renderItems",value:function(){var e=this;this._initialArray.forEach((function(t){return e._renderer(t)}))}},{key:"setItem",value:function(e){this._container.prepend(e)}}])&&n(t.prototype,r),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass),t.textContent=e.validationMessage}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this._inputList)?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass))}},{key:"_setEventListeners",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()})),e._hideInputError(t)}))}},{key:"enableValidation",value:function(){var e=this;this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e._toggleButtonState()})),this._setEventListeners()}}])&&o(t.prototype,n),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),this._popupElement.classList.contains("popup_opened")&&document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.addEventListener("click",(function(t){(t.target.classList.contains("popup__close-button")||t.target.classList.contains("popup"))&&e.close()}))}}])&&u(t.prototype,n),e}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function u(){return s(this,u),i.apply(this,arguments)}return t=u,(n=[{key:"open",value:function(e){var t=e.name,n=e.link;p(h(u.prototype),"open",this).call(this);var r=this._popupElement.querySelector(".popup__image"),o=this._popupElement.querySelector(".popup__preview-title");r.src=n,r.alt=t,o.textContent=t}}])&&c(t.prototype,n),u}(a);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function u(e){var t,n=e.popupSelector,r=e.handleSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._handleSubmit=r,t._formElement=t._popupElement.querySelector(".popup__form"),t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this;return this._inputList=this._formElement.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((function(t){return e._formValues[t.name]=t.value})),this._formValues}},{key:"setEventListeners",value:function(){var e=this;v(g(u.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e._handleSubmit(e._getInputValues()),e.close()}))}},{key:"close",value:function(){v(g(u.prototype),"close",this).call(this),this._formElement.reset()}}])&&d(t.prototype,n),u}(a);function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t){var n=t.name,r=t.job;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._job=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,job:this._job.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.job;this._name.textContent=t,this._job.textContent=n}}])&&S(t.prototype,n),e}(),C={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"},L=document.querySelector(".profile__edit-button"),j=document.querySelector(".profile__add-button"),O=document.querySelector(".popup__form_type_edit-profile"),q=document.querySelector(".popup__form_type_add-card"),I=document.querySelector(".popup__input_type_name"),P=document.querySelector(".popup__input_type_job"),B=function(e){var n=new t(e,{handleCardClick:function(e){var t=e.name,n=e.link;return R.open({name:t,link:n})}},"#cards-template");x.setItem(n.generateCard())},x=new r({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:B},".elements__list");x.renderItems();var R=new y(".popup_type_preview");R.setEventListeners();var T=new k({popupSelector:".popup_type_add-card",handleSubmit:B});T.setEventListeners();var V=new w({name:".profile__name",job:".profile__job"}),D=new k({popupSelector:".popup_type_edit-profile",handleSubmit:function(e){V.setUserInfo({name:e.name,job:e.job})}});D.setEventListeners();var A=new i(C,O),U=new i(C,q);A.enableValidation(),U.enableValidation(),L.addEventListener("click",(function(){var e=V.getUserInfo(),t=e.name,n=e.job;I.value=t,P.value=n,D.open()})),j.addEventListener("click",(function(){T.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNLHdCQUNORSxLQUFNLG1EQUVSLENBQ0VGLEtBQU0saUJBQ05FLEtBQU0saURDZ0JOMkIsU0FBVTJFLEdESGMsbUJDUzVCSSxFQUFVRyxjQUdWLElBQU1MLEVBQWEsSUFBSXpCLEVEUkssdUJDUzVCeUIsRUFBV00sb0JBR1gsSUFBTUMsRUFBZSxJQUFJM0IsRUFBYyxDQUNyQ2QsY0RkMEIsdUJDZTFCZSxhQUFjaUIsSUFHaEJTLEVBQWFELG9CQUdiLElBQU1FLEVBQVcsSUFBSXBCLEVBQVMsQ0FBRTlGLEtETkwsaUJDTXdCK0YsSURMekIsa0JDT3BCb0IsRUFBZ0IsSUFBSTdCLEVBQWMsQ0FDdENkLGNEekI4QiwyQkMwQjlCZSxhQUFjLFNBQUM1RixHQUNidUgsRUFBU0UsWUFBWSxDQUNuQnBILEtBQU1MLEVBQUtLLEtBQ1grRixJQUFLcEcsRUFBS29HLFNBS2hCb0IsRUFBY0gsb0JBR2QsSUFBTUssRUFBb0IsSUFBSWhGLEVBQWM0RCxFQUFtQkcsR0FDekRrQixFQUFvQixJQUFJakYsRUFBYzRELEVBQW1CSSxHQUUvRGdCLEVBQWtCRSxtQkFDbEJELEVBQWtCQyxtQkFHbEJyQixFQUFrQjNFLGlCQUFpQixTQUFTLFdBRTFDLE1BQXNCMkYsRUFBU00sY0FBdkJ4SCxFQUFSLEVBQVFBLEtBQU0rRixFQUFkLEVBQWNBLElBQ2RPLEVBQXFCWCxNQUFRM0YsRUFDN0J1RyxFQUFvQlosTUFBUUksRUFDNUJvQixFQUFjUixVQUdoQlIsRUFBYzVFLGlCQUFpQixTQUFTLFdBQ3RDMEYsRUFBYU4sVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHsgaGFuZGxlQ2FyZENsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7IC8vIGNhbGxiYWNrXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VCdXR0b25Ub2dnbGUoZXZ0KSB7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZWxlbWVudF9faW1hZ2VcIlxuICAgICkuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3RoaXMuX2xpbmt9KWA7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RleHRcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlLWJ1dHRvblwiKTtcbiAgICBjb25zdCBkZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fZGVsZXRlLWJ1dHRvblwiKTtcbiAgICBjb25zdCBwb3B1cEltYWdlUHJldmlldyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcblxuICAgIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uVG9nZ2xlKGV2dClcbiAgICApO1xuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpKTtcblxuICAgIHBvcHVwSW1hZ2VQcmV2aWV3LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHtcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgICAgbGluazogdGhpcy5fbGluayxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5ID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XG4gIH1cblxuICBzZXRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIGRpc2FibGUgc3VibWl0IGJ1dHRvbiBvbiBsb2FkaW5nXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIC8vIHZhbGlkYXRlIGFsbCBpbnB1dHNcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAvLyBjaGVjayB3aGVuZXZlciBhbnkgZmllbGQncyBpbnB1dCBpcyBjaGFuZ2VkXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG5cbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBhZnRlciByZXNldHRpbmcgZm9ybSwgdmFsaWRhdGlvbiBtZXNzYWdlcyBzaG91bGQgYWxzbyByZXNldFxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8vIGNsb3NlIHRoZSBQb3B1cCBieSBQcmVzc2luZyBFc2NhcGUga2V5XG4gIF9oYW5kbGVFc2NDbG9zZShlKSB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xuXG4gICAgaWYgKHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB9XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2UtYnV0dG9uXCIpIHx8IC8vIGNsb3NlIGljb24gb2YgdGhlIHBvcHVwXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgLy8gb3V0c2lkZSBjbGlja1xuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHN1cGVyLm9wZW4oKTtcblxuICAgIGNvbnN0IGltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgIGNvbnN0IHRleHQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcHJldmlldy10aXRsZVwiKTtcbiAgICBpbWFnZS5zcmMgPSBsaW5rO1xuICAgIGltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChcbiAgICAgIChpbnB1dCkgPT4gKHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSlcbiAgICApO1xuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBqb2IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xuICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuICAvLyB0YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IG9uIHRoZSBwYWdlXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBqb2I7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0Rm9ybUNvbmZpZyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IFwiI2NhcmRzLXRlbXBsYXRlXCI7XG5leHBvcnQgY29uc3QgZWxlbWVudHNMaXN0ID0gXCIuZWxlbWVudHNfX2xpc3RcIjtcblxuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIjtcbmV4cG9ydCBjb25zdCBwb3B1cFByZXZpZXcgPSBcIi5wb3B1cF90eXBlX3ByZXZpZXdcIjtcblxuLy8gQnV0dG9uc1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19mb3JtX3R5cGVfZWRpdC1wcm9maWxlXCJcbik7XG5leHBvcnQgY29uc3QgY2FyZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2Zvcm1fdHlwZV9hZGQtY2FyZFwiXG4pO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBcIi5wcm9maWxlX19uYW1lXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZUpvYiA9IFwiLnByb2ZpbGVfX2pvYlwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtSm9iSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wb3B1cF9faW5wdXRfdHlwZV9qb2JcIlxuKTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuaW1wb3J0IHtcbiAgaW5pdGlhbENhcmRzLFxuICBlZGl0Rm9ybUVsZW1lbnQsXG4gIGNhcmRGb3JtRWxlbWVudCxcbiAgZGVmYXVsdEZvcm1Db25maWcsXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBwb3B1cEFkZENhcmQsXG4gIGNhcmRUZW1wbGF0ZSxcbiAgZWxlbWVudHNMaXN0LFxuICBwb3B1cEVkaXRQcm9maWxlLFxuICBwb3B1cFByZXZpZXcsXG4gIGFkZENhcmRCdXR0b24sXG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlSm9iLFxuICBwcm9maWxlRm9ybU5hbWVJbnB1dCxcbiAgcHJvZmlsZUZvcm1Kb2JJbnB1dCxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG4vLyBDcmVhdGUgQ2FyZHNcbmNvbnN0IGNyZWF0ZUNhcmQgPSAoaXRlbSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgaXRlbSxcbiAgICB7IGhhbmRsZUNhcmRDbGljazogKHsgbmFtZSwgbGluayB9KSA9PiBpbWFnZVBvcHVwLm9wZW4oeyBuYW1lLCBsaW5rIH0pIH0sXG4gICAgY2FyZFRlbXBsYXRlXG4gICk7XG4gIGNhcmRzTGlzdC5zZXRJdGVtKGNhcmQuZ2VuZXJhdGVDYXJkKCkpO1xufTtcblxuLy8gR2VuZXJhdGUgQ2FyZHNcbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogY3JlYXRlQ2FyZCxcbiAgfSxcbiAgZWxlbWVudHNMaXN0XG4pO1xuXG4vLyByZW5kZXIgdGhlIGNhcmRzIHRvIHRoZSBET01cbmNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xuXG4vLyBQcmV2aWV3IEltYWdlIFBvcHVwXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwUHJldmlldyk7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEFkZCBOZXcgQ2FyZFxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBwb3B1cEFkZENhcmQsXG4gIGhhbmRsZVN1Ym1pdDogY3JlYXRlQ2FyZCxcbn0pO1xuXG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gUHJvZmlsZSBDYXJkIEZvcm1cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHsgbmFtZTogcHJvZmlsZU5hbWUsIGpvYjogcHJvZmlsZUpvYiB9KTtcblxuY29uc3QgdXNlckluZm9Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wdXBFZGl0UHJvZmlsZSxcbiAgaGFuZGxlU3VibWl0OiAoZGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgIGpvYjogZGF0YS5qb2IsXG4gICAgfSk7XG4gIH0sXG59KTtcblxudXNlckluZm9Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBGb3JtIFZhbGlkYXRvclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihkZWZhdWx0Rm9ybUNvbmZpZywgZWRpdEZvcm1FbGVtZW50KTtcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZGVmYXVsdEZvcm1Db25maWcsIGNhcmRGb3JtRWxlbWVudCk7XG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmNhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gRXZlbnQgTGlzdGVuZXJzXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAvLyBwcmVwb3B1bGF0ZSBwcm9maWxlIGZvcm0gYXQgZmlyc3QgY2xpY2tcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVGb3JtTmFtZUlucHV0LnZhbHVlID0gbmFtZTtcbiAgcHJvZmlsZUZvcm1Kb2JJbnB1dC52YWx1ZSA9IGpvYjtcbiAgdXNlckluZm9Qb3B1cC5vcGVuKCk7XG59KTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBuZXdDYXJkUG9wdXAub3BlbigpO1xufSk7XG4iXSwibmFtZXMiOlsiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUNhcmRDbGljayIsIl9jYXJkU2VsZWN0b3IiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZXZ0IiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2VsZW1lbnQiLCJyZW1vdmUiLCJfZ2V0VGVtcGxhdGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInRleHRDb250ZW50IiwibGlrZUJ1dHRvbiIsImRlbGV0ZUJ1dHRvbiIsInBvcHVwSW1hZ2VQcmV2aWV3IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlQnV0dG9uVG9nZ2xlIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2luaXRpYWxBcnJheSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJmb3JFYWNoIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJzb21lIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJlIiwia2V5IiwiY2xvc2UiLCJjb250YWlucyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQb3B1cFdpdGhJbWFnZSIsImltYWdlIiwidGV4dCIsInNyYyIsImFsdCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJfaGFuZGxlU3VibWl0IiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJVc2VySW5mbyIsImpvYiIsIl9qb2IiLCJkZWZhdWx0Rm9ybUNvbmZpZyIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImVkaXRGb3JtRWxlbWVudCIsImNhcmRGb3JtRWxlbWVudCIsInByb2ZpbGVGb3JtTmFtZUlucHV0IiwicHJvZmlsZUZvcm1Kb2JJbnB1dCIsImNyZWF0ZUNhcmQiLCJjYXJkIiwiaW1hZ2VQb3B1cCIsIm9wZW4iLCJjYXJkc0xpc3QiLCJzZXRJdGVtIiwiZ2VuZXJhdGVDYXJkIiwicmVuZGVySXRlbXMiLCJzZXRFdmVudExpc3RlbmVycyIsIm5ld0NhcmRQb3B1cCIsInVzZXJJbmZvIiwidXNlckluZm9Qb3B1cCIsInNldFVzZXJJbmZvIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJjYXJkRm9ybVZhbGlkYXRvciIsImVuYWJsZVZhbGlkYXRpb24iLCJnZXRVc2VySW5mbyJdLCJzb3VyY2VSb290IjoiIn0=